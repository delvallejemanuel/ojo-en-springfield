<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>El Ojo en Springfield - Quiz Latino</title>
    <style>
        :root {
            --yellow: #FFD90F;
            --blue: #4674b9;
            --dark: #1a1a1a;
            --red: #ff4444;
        }

        body {
            background-color: var(--dark);
            color: white;
            font-family: 'Arial Black', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            margin: 0;
        }

        .stats-container {
            display: flex;
            justify-content: space-between;
            width: 100%;
            max-width: 600px;
            margin-bottom: 10px;
            font-size: 1.2rem;
            color: var(--yellow);
        }

        h1 { color: var(--yellow); text-shadow: 3px 3px #000; margin: 10px 0; font-size: 1.5rem; text-align: center; }

        .tv-frame {
            position: relative;
            width: 100%;
            max-width: 600px;
            background: #333;
            border: 15px solid #444;
            border-radius: 25px;
            overflow: hidden;
            box-shadow: 0 0 50px rgba(0,0,0,0.5);
        }

        .screen {
            width: 100%;
            aspect-ratio: 4 / 3;
            background: #000;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        #episode-img { width: 100%; height: 100%; object-fit: cover; display: none; }

        .scanlines {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%);
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 2;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            width: 100%;
            max-width: 600px;
            margin-top: 20px;
        }

        button {
            background: var(--blue);
            color: white;
            border: 4px solid #fff;
            padding: 12px 5px;
            font-size: 0.8rem;
            font-weight: bold;
            cursor: pointer;
            text-transform: uppercase;
            min-height: 60px;
        }

        button:disabled { opacity: 0.5; cursor: not-allowed; }

        #feedback {
            margin-top: 15px;
            font-size: 1.1rem;
            min-height: 1.5em;
            text-align: center;
            text-transform: uppercase;
        }

        #game-over-overlay {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9);
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 10;
            text-align: center;
        }
    </style>
</head>
<body>

    <div class="stats-container">
        <div>PUNTOS: <span id="score">0</span></div>
        <div>VIDAS: <span id="lives">üç©üç©üç©</span></div>
    </div>

    <h1>EL OJO EN SPRINGFIELD</h1>
    
    <!-- FIX 1: tv-frame ahora se cierra correctamente -->
    <div class="tv-frame">
        <div class="scanlines"></div>
        <div class="screen" id="screen">
            <div id="loader" style="color: var(--yellow)">SINTONIZANDO...</div>
            <img id="episode-img" src="">
            
            <div id="game-over-overlay">
                <h2 style="color: var(--red)">¬°FIN DEL JUEGO!</h2>
                <p>Puntaje Final: <span id="final-score">0</span></p>
                <button onclick="reiniciarJuego()" style="background: var(--yellow); color: black; border-color: black;">REINTENTAR</button>
            </div>
        </div>
    </div>

    <!-- FIX 2: Se agregan los elementos faltantes #options y #feedback -->
    <div class="options-grid" id="options"></div>
    <div id="feedback"></div>

    <!-- FIX 3: El script ahora est√° correctamente fuera del div, antes del cierre del body -->
    <script>
        const diccionario = {
            // TEMPORADA 1
            "S01E01": "Especial de Navidad de los Simpson", "S01E02": "Bart es un genio", "S01E03": "La odisea de Homero", "S01E04": "La familia va a terapia", "S01E05": "Bart el General", "S01E06": "La depresi√≥n de Lisa", "S01E07": "La llamada de los Simpson", "S01E08": "El h√©roe sin cabeza", "S01E09": "Un momento de decisi√≥n", "S01E10": "La noche de fiesta de Homero", "S01E11": "Intercambio cultural", "S01E12": "Krusty va a la c√°rcel", "S01E13": "Una noche encantadora",
            // TEMPORADA 2
            "S02E01": "Bart reprueba", "S02E02": "Encuentro cercano con el tipo de su misma especie", "S02E03": "Especial de noche de brujas", "S02E04": "Dos coches en cada garaje y tres ojos en cada pez", "S02E05": "Homero el animador", "S02E06": "El club de los patteos muertos", "S02E07": "Bart en el d√≠a de gracias", "S02E08": "Bart el temerario", "S02E09": "Tommy, Daly y Marge", "S02E10": "Bart es atropellado", "S02E11": "Aviso de muerte", "S02E12": "Nuestros a√±os felices", "S02E13": "Homero contra el octavo mandamiento", "S02E14": "El director encantador", "S02E15": "¬øD√≥nde est√°s hermano m√≠o?", "S02E16": "El buen perrito", "S02E17": "Bart el vendedor", "S02E18": "Pinta con grandeza", "S02E19": "El sustituto de Lisa", "S02E20": "La guerra de los Simpson", "S02E21": "Tres hombres y una historieta", "S02E22": "Sangre nueva",
            // TEMPORADA 3
            "S03E01": "Pap√° est√° loco", "S03E02": "El patriotismo de Lisa", "S03E03": "Cuando Flanders fracas√≥", "S03E04": "Bart el asesino", "S03E05": "Definici√≥n de Homero", "S03E06": "De tal palo tal payaso", "S03E07": "Especial de noche de brujas II", "S03E08": "El pony de Lisa", "S03E09": "S√°bados de trueno", "S03E10": "Llamarada Moe", "S03E11": "Burns y los alemanes", "S03E12": "Me cas√© con Marge", "S03E13": "Radio Bart", "S03E14": "Bart el amante", "S03E15": "Homero se queda solo", "S03E16": "Bart el sabelotodo", "S03E17": "Homero al bat", "S03E18": "Vocaciones distintas", "S03E19": "Muerte de perros", "S03E20": "Homero el granjero", "S03E21": "El viudo negro", "S03E22": "El otomano de Otto", "S03E23": "El hermano de Homero pide prestado",
            // TEMPORADA 4
            "S04E01": "Kampamento Krusty", "S04E02": "Un tranv√≠a llamado Marge", "S04E03": "Homero el hereje", "S04E04": "Lisa la reina de la belleza", "S04E05": "Especial de noche de brujas III", "S04E06": "Iztichy y Scratchy: La pel√≠cula", "S04E07": "Marge consigue un empleo", "S04E08": "La chica nueva", "S04E09": "Don Barredora", "S04E10": "La primera palabra de Maggie", "S04E11": "El gran coraz√≥n de Homero", "S04E12": "Marge contra el monorriel", "S04E13": "La elecci√≥n de Selma", "S04E14": "Hermano del mismo planeta", "S04E15": "Yo amo a Lisa", "S04E16": "Sin Duff", "S04E17": "La √∫ltima salida a Springfield", "S04E18": "A esto hemos llegado", "S04E19": "El frente de la tormenta", "S04E20": "El d√≠a del garrote", "S04E21": "Marge en cadenas", "S04E22": "El drama de Krusty",
            // TEMPORADA 5
            "S05E01": "El cuarteto de Homero", "S05E02": "Cabo de miedos", "S05E03": "Homero va a la universidad", "S05E04": "El oso de Burns", "S05E05": "Especial de noche de brujas IV", "S05E06": "Marge la rebelde", "S05E07": "Filosof√≠a bartiana", "S05E08": "Exploradores de inc√≥gnito", "S05E09": "La √∫ltima tentaci√≥n de Homero", "S05E10": "Springfield pr√≥spero", "S05E11": "Homero el vigilante", "S05E12": "Bart se hace famoso", "S05E13": "Homero en el espacio exterior", "S05E14": "Lisa contra la Baby Malib√∫", "S05E15": "Homero ama a Flanders", "S05E16": "Bart gana un elefante", "S05E17": "El heredero de Burns", "S05E18": "La canci√≥n de Skinner", "S05E19": "El ni√±o que sab√≠a demasiado", "S05E20": "El amante de Lady Bouvier", "S05E21": "Secretos de una boda exitosa",
            // TEMPORADA 6
            "S06E01": "Bart de oscuridad", "S06E02": "La rival de Lisa", "S06E03": "Otra pel√≠cula de los Simpson", "S06E04": "La tierra de Tomy y Daly", "S06E05": "El regreso de Bob Pati√±o", "S06E06": "Especial de noche de brujas V", "S06E07": "La novia de Bart", "S06E08": "Lisa y los deportes", "S06E09": "Homero el malo", "S06E10": "El abuelo contra la impotencia sexual", "S06E11": "Miedo a volar", "S06E12": "Homero el Grande", "S06E13": "And Just Maggie Makes Three", "S06E14": "El cometa de Bart", "S06E15": "Homero el payaso", "S06E16": "Bart contra Australia", "S06E17": "Homero contra Patty y Selma", "S06E18": "Una estrella nace", "S06E19": "La boda de Lisa", "S06E20": "Un galgo llamado Monty", "S06E21": "22 pel√≠culas cortas sobre Springfield", "S06E22": "El limonero de Troya", "S06E23": "¬øQui√©n mat√≥ al Sr. Burns? (Parte 1)",
            // TEMPORADA 7
            "S07E01": "¬øQui√©n mat√≥ al Sr. Burns? (Parte 2)", "S07E02": "Mi querido capit√°n", "S07E03": "Hogar dulce ho-garcito", "S07E04": "Bart vende su alma", "S07E05": "Lisa la vegetariana", "S07E06": "Especial de noche de brujas VI", "S07E07": "Homero tama√±o familiar", "S07E08": "Marge, no seas orgullosa", "S07E09": "El √∫ltimo suspiro de Bob Pati√±o", "S07E10": "El espectacular de los Simpson",
            // FIX 4: S07E11 ten√≠a nombre duplicado, corregido
            "S07E11": "El factor miedo de Lisa", "S07E12": "El equipo de Homero", "S07E13": "Dos malos vecinos", "S07E14": "Escenas de la lucha de clases en Springfield", "S07E15": "Bart el sopl√≥n", "S07E16": "Lisa la iconoclasta", "S07E17": "Homero el Smithers", "S07E18": "El d√≠a que muri√≥ la violencia", "S07E19": "Un pez llamado Selma", "S07E20": "Bart recorre el mundo", "S07E21": "22 pel√≠culas cortas sobre Springfield", "S07E22": "Mi h√©roe el abuelo", "S07E23": "Mucho Apu y pocas nueces", "S07E24": "Homero el de las reservas", "S07E25": "Verano de metro y medio",
            // TEMPORADA 8
            "S08E01": "Especial de noche de brujas VII", "S08E02": "Solo se muda dos veces", "S08E03": "Homero por el campeonato", "S08E04": "Papi gallo", "S08E05": "Plus ultra", "S08E06": "Milhouse dividido", "S08E07": "La soplona de Lisa", "S08E08": "Hurac√°n Neddy", "S08E09": "El viaje misterioso de nuestro Homero", "S08E10": "Las torres de Springfield", "S08E11": "El mundo de Tomy y Daly", "S08E12": "La monta√±a de la locura", "S08E13": "Simpsoncalifragilisticoexpialidoso", "S08E14": "El espect√°culo de Tomy, Daly y Poochie", "S08E15": "La fobia de Homero", "S08E16": "El hermano de otra serie", "S08E17": "Ni√±era mi hermana", "S08E18": "Homero contra la prohibici√≥n", "S08E19": "Amamos pedirle a Lisa", "S08E20": "Mot√≠n canino", "S08E21": "El viejo y Lisa", "S08E22": "En Marge confiamos", "S08E23": "El enemigo de Homero", "S08E24": "El repertorio de los Simpson", "S08E25": "La guerra secreta de Lisa Simpson",
            // TEMPORADA 9
            "S09E01": "La ciudad de Nueva York contra Homero", "S09E02": "El director y el pillo", "S09E03": "El sax de Lisa", "S09E04": "Especial de noche de brujas VIII", "S09E05": "La familia Cartridge", "S09E06": "Bart se convierte en estrella", "S09E07": "La boda de Apu", "S09E08": "Lisa la esc√©ptica", "S09E09": "La farsa de las variantes", "S09E10": "Milagro en la calle Siempreviva", "S09E11": "Todas las canciones en el repertorio", "S09E12": "Bart en la feria", "S09E13": "La secta Simpson", "S09E14": "Das Bus", "S09E15": "La √∫ltima tentaci√≥n de Krusty", "S09E16": "El enga√±o de Dumbbell", "S09E17": "Lisa la Simpson", "S09E18": "Gorgorito", "S09E19": "Mi querido capit√°n Simpson", "S09E20": "Mundo de basura", "S09E21": "Ni√±o rudo", "S09E22": "Residuos tit√°nicos", "S09E23": "El rey de la monta√±a", "S09E24": "Lisa tiene un romance con la lectura", "S09E25": "Natural Born Kissers"
        };

        let score = 0;
        let lives = 3;
        let respuestaCorrecta = "";
        let juegoActivo = true;

        async function nuevaPregunta() {
            if (!juegoActivo) return;

            document.getElementById('loader').style.display = "block";
            document.getElementById('episode-img').style.display = "none";
            document.getElementById('options').innerHTML = "";
            document.getElementById('feedback').innerText = "";

            const codigos = Object.keys(diccionario);
            const codigo = codigos[Math.floor(Math.random() * codigos.length)];
            respuestaCorrecta = diccionario[codigo];

            try {
                const res = await fetch(`https://frinkiac.com/api/random?e=${codigo}`);
                const data = await res.json();
                const imgUrl = `https://frinkiac.com/img/${data.Frame.Episode}/${data.Frame.Timestamp}.jpg`;
                
                const imgElement = document.getElementById('episode-img');
                imgElement.src = imgUrl;
                imgElement.onload = () => {
                    document.getElementById('loader').style.display = "none";
                    imgElement.style.display = "block";
                    mostrarOpciones();
                };
            } catch (e) {
                document.getElementById('loader').innerText = "ERROR DE SE√ëAL";
            }
        }

        function mostrarOpciones() {
            const nombres = Object.values(diccionario);
            let opciones = [respuestaCorrecta];

            while(opciones.length < 4) {
                let rando = nombres[Math.floor(Math.random() * nombres.length)];
                if(!opciones.includes(rando)) opciones.push(rando);
            }
            opciones.sort(() => Math.random() - 0.5);

            const container = document.getElementById('options');
            opciones.forEach(opt => {
                const btn = document.createElement('button');
                btn.innerText = opt;
                btn.onclick = () => verificar(opt, btn);
                container.appendChild(btn);
            });
        }

        function verificar(seleccion, boton) {
            const f = document.getElementById('feedback');
            const botones = document.querySelectorAll('#options button');
            botones.forEach(b => b.disabled = true);

            if(seleccion === respuestaCorrecta) {
                score += 10;
                document.getElementById('score').innerText = score;
                f.innerText = "¬°PERFECTIRIJILLO! ‚ú®";
                f.style.color = "var(--yellow)";
                setTimeout(nuevaPregunta, 1500);
            } else {
                lives--;
                actualizarVidas();
                f.innerHTML = `¬°D'OH! Era:<br><small>${respuestaCorrecta}</small>`;
                f.style.color = "var(--red)";
                
                if (lives <= 0) {
                    finalizarJuego();
                } else {
                    setTimeout(nuevaPregunta, 2500);
                }
            }
        }

        function actualizarVidas() {
            const l = document.getElementById('lives');
            l.innerText = "üç©".repeat(lives);
        }

        function finalizarJuego() {
            juegoActivo = false;
            document.getElementById('game-over-overlay').style.display = "flex";
            document.getElementById('final-score').innerText = score;
        }

        function reiniciarJuego() {
            score = 0;
            lives = 3;
            juegoActivo = true;
            document.getElementById('score').innerText = "0";
            actualizarVidas();
            document.getElementById('game-over-overlay').style.display = "none";
            nuevaPregunta();
        }

        nuevaPregunta();
    </script>
</body>
</html>
